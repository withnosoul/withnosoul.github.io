---
title: 浏览器
date: 2022-07-27 23:37:52
permalink: /pages/bfc8a9/
---


## 浏览器渲染过程
1. 解析HTML、生成DOM树；解析CSS，生成CSSOM树 
2. 将DOM树和CSSOM树结合，生成渲染树（Render Tree） 
3. Layout（回流）：根据生成的渲染树，进行回流，得到节点的几何信息（位置、大小） 
4. Repaint（重绘）：根据渲染树依据回流得到的几何信息，得到节点的绝对像素 
5. Display：将像素发给GPU，展示在页面上

::: center
![img](~@alias/browser-render.png)
:::

[你真的了解回流和重绘吗？](https://github.com/chenjigeng/blog/issues/4)

### 回流
前面我们通过构造渲染树，我们将可见DOM节点以及它对应的样式结合起来， 可是我们还需要计算它们在设备视口（viewport）内的确切位置和大小， 这个计算的阶段就是回流

### 重绘
通过构造渲染树和回流，我们知道了哪些节点是可见的，以及可见节点的样式和具体的几何信息（位置、大小）， 那么我们就可以将渲染树的每个节点都转换位屏幕上的实际像素，这个阶段叫做重绘节点。

**何时发生回流重绘**

前面我们知道，回流这一阶段主要是计算接待你的位置和几何信息，那么当页面布局和几何信息发生变化的时候，就需要回流。 比如一下情况：
1. 页面一开始渲染的时候（这必然的） 
2. 添加或删除可见的DOM元素 
3. 元素的位置发生变化 
4. 元素的尺寸发生变化（包括外边距、内边距、边框大小、高度和宽度等） 
5. 内容发生变化，比如文本变化或图片被另一个不同尺寸的图片所替代 
6. 浏览器的窗口尺寸变化（因为回流是根据视口的大小来计算元素的位置和大小的）

::: tip 提示
回流一定会触发重绘，而重绘不一定会回流。
:::
